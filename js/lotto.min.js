/**
    Website:  ClassClever
    Project:  CC Lotto
    Autor:    Sarun Seepun
**/
function updateMoneyChart(t,e){if(void 0!==window.moneyChart){window.moneyChartData.labels.push(t),t>18&&window.moneyChartData.labels.shift();for(let a=0;a<window.moneyChartData.datasets.length;++a)"object"==typeof window.moneyChartData.datasets[a].data[0]?window.moneyChartData.datasets[a].data.push({x:t,y:e}):window.moneyChartData.datasets[a].data.push(e),t>18&&window.moneyChartData.datasets[a].data.shift();window.moneyChart.update()}}function updateLotteryNumChart(t,e){if(void 0!==window.lotteryNumChart){window.lotteryNumChartData.labels.push(t),t>18&&window.lotteryNumChartData.labels.shift();for(let a=0;a<window.lotteryNumChartData.datasets.length;++a)"object"==typeof window.lotteryNumChartData.datasets[a].data[0]?window.lotteryNumChartData.datasets[a].data.push({x:t,y:e}):window.lotteryNumChartData.datasets[a].data.push(e),t>18&&window.lotteryNumChartData.datasets[a].data.shift();window.lotteryNumChart.update()}}function updateWonChart(t,e){if(void 0!==window.wonChart){window.wonChartData.labels.push(t),t>18&&window.wonChartData.labels.shift();for(let a=0;a<window.wonChartData.datasets.length;++a)"object"==typeof window.wonChartData.datasets[a].data[0]?window.wonChartData.datasets[a].data.push({x:t,y:e}):window.wonChartData.datasets[a].data.push(e),t>18&&window.wonChartData.datasets[a].data.shift();window.wonChart.update()}}function updateRatioDonut(t,e){if(void 0!==window.ratioDonut){for(let a=0;a<window.ratioDonutData.datasets.length;++a)window.ratioDonutData.datasets[a].data[0]+=t,window.ratioDonutData.datasets[a].data[1]+=e;window.ratioDonut.update()}}Number.prototype.pad=function(t){for(var e=String(this);e.length<(t||2);)e="0"+e;return e},Number.prototype.moneyFormat=function(){return this.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};class Lottor{constructor(t,e){this.hand=$(t),this.money=e,this.lotteries=[],this.moneyHistory=[e],this.lotteryNumHistory=[],this.wonHistory=[],this.updateReport()}lotteryCount(){return this.lotteries.length}getLottery(t){return this.lotteries[t]}pick(t){if(this.money<t.price){if(this.lotteryCount()>0)$("#broke-last-chance-modal").addClass("fancybox-is-open").show(),$("#broke-last-chance-modal .fancybox-content").addClass("fadeInDown").removeClass("fadeOutUp");else if(!$("#broke-modal").hasClass("fancybox-is-open")){let t=this.getTotalPrize();$(".broke-title").html("เงินของคุณ...หมดแล้ว..."),$("#broke-modal").addClass("fancybox-is-open").show(),$("#broke-modal .fancybox-content").removeClass("fadeOutUp").addClass("fadeInDown"),$("#total_prize").val(t),$(".total_prize").html(t.moneyFormat())}return!1}{this.money-=t.price,this.lotteries.push(t),this.updateReport();let e=this;return setTimeout(function(){t.onLottor(e.hand)},700),!0}}getTotalPrize(){let t=0;for(let e=0;e<this.wonHistory.length;e++)t+=this.wonHistory[e];return t}updateReport(){$("#money").html(this.money.moneyFormat()),$(".lottery-num").html(this.lotteryCount())}nextPeriod(t){let e=0;for(let a=0;a<t.length;a++)e+=t[a].prize;let a=0;this.lotteries.length>0&&(a+=this.lotteries.length*this.lotteries[0].price),this.moneyHistory.push(this.money+e),this.lotteryNumHistory.push(this.lotteries.length),this.wonHistory.push(e),updateMoneyChart(this.moneyHistory.length,this.money+e),updateLotteryNumChart(this.lotteryNumHistory.length,this.lotteries.length),updateWonChart(this.wonHistory.length,e),updateRatioDonut(e,a),updateLottoDatabase(this.moneyHistory,this.lotteryNumHistory,this.wonHistory),this.lotteries=[],this.hand.html(""),this.money+=e,this.updateReport()}}class Lottery{constructor(){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",e=t.length,a="";for(let i=0;i<12;i++)a+=t[Math.round(Math.random()*(e-1))];this.id=a,this.price=80,this.on_panel=!1,this.panel_index=-1,this.number=Math.round(999999*Math.random()).pad(6),this.head=this.number.substr(0,3),this.tail=this.number.substr(3,3),this.two=this.number.substr(4,2)}info(){console.log(this)}numberDisplay(){let t=["ZER","ONE","TWO","THR","FOU","FIV","SIX","SEV","EIG","NIN"],e="";for(let a=0;a<6;a++)e+='<div class="num">'+this.number[a]+"<br><span>"+t[Number(this.number[a])]+"</span></div>";return e}onPanel(t){this.on_panel||(this.on_panel=!0,t.append('<div class="lottery" lottery-id="'+this.id+'"><div class="wrapper"><div style="float:right">'+this.numberDisplay()+"</div></div></div>"))}onLottor(t){this.on_panel&&(this.on_panel=!1,t.append('<div class="lottery">'+this.numberDisplay()+"</div>"))}}class LotteryPrize{constructor(t,e){this.prize_space=$(t),this.prize_space.html(""),this.period=e,this.prizes=[],this.prizeWons=[],$("#prize-summary-modal .summary").html("")}nextPeriod(t){$(".lottery-prize-container").removeClass("active"),t.nextPeriod(this.prizeWons),this.period+=1,this.prizes=[],this.prizeWons=[];let e=this;setTimeout(function(){e.prize_space.html(""),$("#prize-summary-modal .summary").html("")},600)}generate(t){$(".lottery-prize-container").addClass("active");let e=Math.round(999998*Math.random())+1,a=[e.pad(6),(e-1).pad(6),(e+1).pad(6)],i=[];for(;i.length<4;){let t=Math.round(999*Math.random()).pad(3);-1==i.indexOf(t)&&i.push(t)}for(;a.length<168;){let e=Math.round(999999*Math.random()).pad(6);if(-1==a.indexOf(e)&&(a.push(e),168==a.length)){this.generatePrizes(t,a,i);break}}}generatePrizes(t,e,a){let i=Math.round(99*Math.random()).pad(2);this.prizes=[{id:1,prize_name:"รางวัลที่ 1",prize:6e6,numbers:[e[0]]},{id:2,prize_name:"เลขหน้า 3 ตัว",prize:4e3,numbers:a.slice(0,2)},{id:3,prize_name:"เลขท้าย 3 ตัว",prize:4e3,numbers:a.slice(2,4)},{id:4,prize_name:"เลขท้าย 2 ตัว",prize:2e3,numbers:i},{id:5,prize_name:"รางวัลข้างเคียงรางวัลที่ 1",prize:1e5,numbers:e.slice(1,3)},{id:6,prize_name:"รางวัลที่ 2",prize:2e5,numbers:e.slice(3,8)},{id:7,prize_name:"รางวัลที่ 3",prize:8e4,numbers:e.slice(8,18)},{id:8,prize_name:"รางวัลที่ 4",prize:4e4,numbers:e.slice(18,68)},{id:9,prize_name:"รางวัลที่ 5",prize:2e4,numbers:e.slice(68,168)}];let r='<div class="formatted" style="text-align:center;"><div class="delimeter-md"></div><h1>ผล CC ลอตเตอรี่ <span>งวดที่ '+this.period+"</span></h1>";r+='<div class="btn-container" style="text-align:center; margin-bottom:20px;"><a href="#" class="btn btn-primary lottery-prize-summary" style="float:none;" data-fancybox="" data-animation-duration="300" data-src="#prize-summary-modal">สรุปผลงวดนี้ !</a></div>',r+='<div class="table-wrapper">',r+='<table class="big-prize-table"><tr><th><span>รางวัลที่ 1</span><br>รางวัลละ 6,000,000 บาท</th><th><span>เลขหน้า 3 ตัว</span><br>รางวัลละ 4,000 บาท</th><th><span>เลขท้าย 3 ตัว</span><br>รางวัลละ 4,000 บาท</th><th><span>เลขท้าย 2 ตัว</span><br>รางวัลละ 2,000 บาท</th></tr><tr><td><h3><span>'+e[0]+"</span></h3></td><td><h4>"+a[0]+"&nbsp;&nbsp;&nbsp;"+a[1]+"</h4></td><td><h4>"+a[2]+"&nbsp;&nbsp;&nbsp;"+a[3]+"</h4></td><td><h4>"+i+"</h4></td></tr></table>",r+="<table><tr><th><span>รางวัลข้างเคียงรางวัลที่ 1</span><br>รางวัลละ 100,000 บาท</th><td><h4>"+e[1]+"</h4></td><td><h4>"+e[2]+"</h4></td></tr></table>",r+='<table class="prize-table"><tr><td colspan="5"><h5><span>รางวัลที่ 2 รางวัลละ 200,000 บาท</span></h5></td></tr>',r+="<tr>";for(let t=3;t<8;t++)r+="<td>"+e[t]+"</td>";r+="</tr>",r+="</table>",r+='<table class="prize-table"><tr><td colspan="5"><h5><span>รางวัลที่ 3 รางวัลละ 80,000 บาท</span></h5></td></tr>',r+="<tr>";for(let t=8;t<13;t++)r+="<td>"+e[t]+"</td>";r+="</tr>",r+="<tr>";for(let t=13;t<18;t++)r+="<td>"+e[t]+"</td>";r+="</tr>",r+="</table>",r+='<table class="prize-table"><tr><td colspan="5"><h5><span>รางวัลที่ 4 รางวัลละ 40,000 บาท</span></h5></td></tr>';for(let t=0;t<10;t++){r+="<tr>";for(let a=5*t+18;a<5*t+23;a++)r+="<td>"+e[a]+"</td>";r+="</tr>"}r+="</table>",r+='<table class="prize-table"><tr><td colspan="5"><h5><span>รางวัลที่ 5 รางวัลละ 20,000 บาท</span></h5></td></tr>';for(let t=0;t<20;t++){r+="<tr>";for(let a=5*t+68;a<5*t+73;a++)r+="<td>"+e[a]+"</td>";r+="</tr>"}r+="</table>",r+="</div></div>",this.prize_space.html(r),this.generateWonPrizes(t)}generateWonPrizes(t){if(this.prizeWons=[],t.lotteryCount())for(let e=0;e<t.lotteryCount();e++){let a=!1,i=t.getLottery(e);for(let t=0;t<this.prizes.length;t++)if(!a){let e=this.prizes[t];2==e.id?e.numbers.indexOf(i.head)>-1&&(a=!0,this.addWonPrize(i,e)):3==e.id?e.numbers.indexOf(i.tail)>-1&&(a=!0,this.addWonPrize(i,e)):4==e.id?e.numbers.indexOf(i.two)>-1&&(a=!0,this.addWonPrize(i,e)):e.numbers.indexOf(i.number)>-1&&(a=!0,this.addWonPrize(i,e))}e==t.lotteryCount()-1&&this.generateWonPrizeSummary(!0)}else this.generateWonPrizeSummary(!1)}addWonPrize(t,e){this.prizeWons.push({number:t.number,prize_name:e.prize_name,prize:e.prize})}generateWonPrizeSummary(t){let e="";if(t)if(this.prizeWons.length){e+='<h2 class="primary-color">งวดนี้คุณดวงดี !</h2><div class="delimeter-xs"></div><hr><div class="delimeter-sm"></div><div class="table-wrapper"><table>';for(let t=0;t<this.prizeWons.length;t++){let a=this.prizeWons[t];e+="<tr><td>"+a.number+"</td><td>"+a.prize_name+'</td><td class="text-red">'+a.prize.moneyFormat()+"</td></tr>"}e+="</table></div>"}else e+='<h2 class="primary-color">งวดนี้...คุณถูกกินเรียบ !</h2><div class="delimeter-xs"></div><hr>';else e+='<h2 class="primary-color">คุณไม่ได้ซื้อลอตเตอรี่ในงวดนี้</h2><div class="delimeter-xs"></div><hr>';$("#prize-summary-modal .summary").html(e)}}class LotteryGame{constructor(t,e,a){this.panel=$(t),this.lotteries=[],this.lottor=e,this.lottoryPrize=a,this.ready=!1,$(".toggle-lottor").click(function(t){t.preventDefault(),$(".lottor-container").toggleClass("active")})}setup(){this.ready=!0,this.lotteries=[],this.panel.html("");let t=15;window.innerWidth<575.98?t=6:window.innerWidth<767.98?t=8:window.innerWidth<1399.98&&(t=12);for(let e=0;e<t;e++)this.add(new Lottery);this.updateBinding(),$("#period").html("งวดที่ "+this.lottoryPrize.period)}resetup(){$(".lottery").unbind(),$("#pick-all-lotteries").unbind(),$("#new-lotteries").unbind(),this.lotteries=[],this.panel.removeClass("fadeInRight").addClass("zoomOutLeft");let t=this;setTimeout(function(){t.panel.removeClass("zoomOutLeft").addClass("fadeInRight").html(""),t.setup()},100)}resetup2(){$(".lottery").unbind(),$("#pick-all-lotteries").unbind(),$("#new-lotteries").unbind(),this.lotteries=[],this.panel.removeClass("fadeInRight").addClass("zoomOutLeft");let t=this;setTimeout(function(){t.panel.removeClass("zoomOutLeft").addClass("fadeInRight").html(""),t.setup()},800)}add(t){return t.on_panel||(this.lotteries.push(t),t.onPanel(this.panel)),this}updateBinding(){let t=this;$(".lottery").unbind(),this.panel.find(".lottery").click(function(){if(t.ready&&!$(this).hasClass("selected")){t.ready=!1;let e=$(this).attr("lottery-id"),a=t.lotteries.length;for(let i=0;i<a;i++)if(t.lotteries[i].id==e){t.lottor.pick(t.lotteries[i])?(t.lotteries.splice(i,1),$(this).addClass("selected animated fadeOutDown"),t.lotteries.length?t.ready=!0:setTimeout(function(){t.resetup()},850),t.lottor.lotteryCount()>=50&&($("#new-lotteries").attr("disabled",!0),t.lotteries.length||($("#pick-all-lotteries").attr("disabled",!0),$(".lottery-panel-status").addClass("active")))):($("#new-lotteries").attr("disabled",!0),$("#pick-all-lotteries").attr("disabled",!0));break}}}),$("#pick-all-lotteries").unbind(),$("#pick-all-lotteries").click(function(e){if(e.preventDefault(),t.ready){t.ready=!1;let e=t.lotteries.length;if(t.lottor.money>=t.lotteries.length*t.lotteries[0].price){for(let a=0;a<e;a++)t.lottor.pick(t.lotteries[a]);t.panel.find(".lottery").addClass("selected animated fadeOutDown"),t.lotteries=[],t.lottor.lotteryCount()<50?setTimeout(function(){t.resetup()},850):($("#new-lotteries").attr("disabled",!0),$("#pick-all-lotteries").attr("disabled",!0),$(".lottery-panel-status").addClass("active"))}else{let a=0;for(;t.lottor.pick(t.lotteries[a]);)t.panel.find('.lottery[lottery-id="'+t.lotteries[a].id+'"]').addClass("selected animated fadeOutDown"),a+=1;t.lotteries=t.lotteries.slice(a,e),$("#new-lotteries").attr("disabled",!0),$("#pick-all-lotteries").attr("disabled",!0)}}}),$("#new-lotteries").unbind(),$("#new-lotteries").click(function(e){e.preventDefault(),t.ready&&(t.ready=!1,t.resetup2())}),$("#prize-announce-btn, .prize-announce-btn").unbind(),$("#prize-announce-btn").click(function(){t.lottoryPrize.generate(t.lottor)}),$(".prize-announce-btn").click(function(){t.lottoryPrize.generate(t.lottor),$("#broke-last-chance-modal").removeClass("fancybox-is-open").hide(),$("#broke-last-chance-modal .fancybox-content").removeClass("fadeInDown").addClass("fadeOutUp")}),$("#lottery-next-period").unbind(),$("#lottery-next-period").click(function(){$("#new-lotteries").attr("disabled",!1),$("#pick-all-lotteries").attr("disabled",!1),$(".lottery-panel-status").removeClass("active"),$("html,body").animate({scrollTop:0},350),t.lottoryPrize.nextPeriod(t.lottor),t.setup()})}}